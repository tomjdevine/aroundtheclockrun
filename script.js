// Translation System
const translations = {
    nl: {
        'page-title': 'Rond de Klok voor de NCFS - 24 Uur Team Estafette Loop',
        'nav-logo': 'Rond de Klok voor de NCFS',
        'nav-home': 'Home',
        'nav-about': 'Over',
        'nav-event': 'Evenement Details',
        'nav-language': 'EN',
        'hero-title': '24 Uur. Eén Baan. Eén Doel.',
        'hero-description': 'Een uithoudingsestafette zoals geen ander: 24 uur lang houden teams één loper constant in beweging, rondjes draaiend op de AVC baan om cruciale fondsen te werven voor cystic fibrosis onderzoek en ondersteuning via de NCFS.',
        'hero-register': 'Registreer Je Team →',
        'stat-hours': 'Uur',
        'stat-runners': 'Lopers per Team',
        'stat-goal-number': '1 Doel',
        'stat-goal': 'Steun de NCFS',
        'hero-date': '5 & 6 april 2026',
        'about-title': 'Over het Evenement',
        'about-text-1': 'Deze 24-uurs team estafette loop is meer dan alleen een race – het is een viering van gemeenschap, uithoudingsvermogen en steun voor mensen die getroffen zijn door Cystic Fibrosis. De Nederlandse Cystic Fibrosis Stichting (NCFS) ondersteunt onderzoeksinspanningen om deze ziekte aan te pakken en helpt gezinnen in moeilijke tijden.',
        'about-text-2': 'Teams van maximaal 6 lopers zullen 24 uur lang de 400m atletiekbaan lopen, een echte test van uithoudingsvermogen. Terwijl één loper van elk team op de baan is, zal de rest van het team hun loper ondersteunen en genieten van de kampeeratmosfeer in tenten of campers naast de baan, wat een festivalachtig gevoel creëert.',
        'about-why-title': 'Waarom NCFS?',
        'about-why-text': 'De Nederlandse Cystic Fibrosis Stichting biedt cruciale ondersteuning aan gezinnen die getroffen zijn door Cystic Fibrosis, waaronder medische zorg, onderzoeksfinanciering en gemeenschapsondersteuning. Dit evenement is onze manier om iets terug te geven aan een organisatie die een echt verschil heeft gemaakt in ons leven.',
        'about-why-link': 'Meer informatie',
        'about-image-text': 'Steun de NCFS',
        'event-title': 'Evenement Details',
        'event-date-title': 'Datum & Tijd',
        'event-date-text': 'De loop begint om 14:00 op 5 april 2026 en eindigt om 14:00 op 6 april',
        'event-location-title': 'Locatie',
        'event-team-title': 'Teamgrootte',
        'event-team-text': 'Maximaal 6 lopers per team. Teams kunnen lopers naar behoefte roteren tijdens de 24 uur',
        'event-prizes-title': 'Prijzen',
        'event-prizes-text': 'Top 3 teams voor opgehaalde fondsen en totale afgelegde afstand',
        'rules-title': 'Evenement Regels & Richtlijnen',
        'rules-running-title': 'Loopregels',
        'rules-running-1': 'Minimaal één loper per team op de baan te allen tijde',
        'rules-running-2': 'Teams kunnen lopers zo vaak roteren als nodig',
        'rules-running-3': 'Alle lopers moeten binnen het aangewezen baan gebied blijven',
        'rules-running-4': 'Veiligheid is onze topprioriteit - volg alle baanregels',
        'rules-camping-title': 'Kamperen & Faciliteiten',
        'rules-camping-1': 'Teams kunnen tenten opzetten of campers meenemen',
        'rules-camping-2': 'Aangewezen kampeergebieden worden beschikbaar gesteld',
        'rules-camping-3': 'Basisvoorzieningen zijn beschikbaar op locatie',
        'rules-camping-4': 'Neem je eigen eten en drinken mee',
        'rules-camping-5': 'Respecteer de ruimte van andere teams en houd het geluidsniveau redelijk',
        'rules-fundraising-title': 'Fondsenwerving',
        'rules-fundraising-1': 'Elk team wordt aangemoedigd om fondsen te werven voor NCFS',
        'rules-fundraising-2': 'Fondsenwervingsvoortgang wordt gedurende het evenement bijgehouden',
        'rules-fundraising-3': 'Alle donaties gaan direct naar NCFS',
        'rules-fundraising-4': 'Teams maken hun eigen actie aan op de NCFS fondsenwervingssite',
        'footer-title': 'Rond de Klok Loop',
        'footer-description': '24-uurs team estafette loop ter ondersteuning van de Nederlandse Cystic Fibrosis Stichting (NCFS)',
        'footer-links-title': 'Snelle Links',
        'footer-support-title': 'Steun NCFS',
        'footer-support-text': 'Lees meer over de Nederlandse Cystic Fibrosis Stichting en hun belangrijke werk ter ondersteuning van gezinnen die getroffen zijn door Cystic Fibrosis.',
        'footer-copyright': '© 2024 Rond de Klok Loop. Alle rechten voorbehouden.',
        'form-title': 'Registreer Je Team',
        'form-team-name': 'Teamnaam *',
        'form-team-name-placeholder': 'Voer je teamnaam in',
        'form-captain-name': 'Team Captain Naam *',
        'form-captain-name-placeholder': 'Volledige naam van team captain',
        'form-captain-email': 'Team Captain Email *',
        'form-captain-phone': 'Team Captain Telefoon *',
        'form-description': 'Team Beschrijving',
        'form-description-placeholder': 'Vertel ons over je team, je motivatie of bijzondere details...',
        'form-members': 'Teamleden (max 6) *',
        'form-members-placeholder': 'Lijst de namen van alle teamleden op (één per regel)',
        'form-members-hint': 'Gelieve de naam van elk teamlid op een aparte regel te vermelden',
        'form-info-title': 'Wat gebeurt er daarna?',
        'form-info-text': 'Nadat je je registratie hebt ingediend, zullen de organisatoren je registratie bevestigen en je de logistieke informatie voor de loop per e-mail sturen in de loop van de tijd.',
        'form-cancel': 'Annuleren',
        'form-submit': 'Registratie Indienen',
        'form-sending': 'Verzenden...'
    },
    en: {
        'page-title': 'Around the Clock for the NCFS - 24 Hour Team Relay Run',
        'nav-logo': 'Around the Clock for the NCFS',
        'nav-home': 'Home',
        'nav-about': 'About',
        'nav-event': 'Event Details',
        'nav-language': 'NL',
        'hero-title': '24 Hours. One Track. One Goal.',
        'hero-description': 'An endurance relay unlike any other: for 24 hours, teams keep one runner on the move at all times, circling the AVC track to raise critical funds for cystic fibrosis research and support through the NCFS.',
        'hero-register': 'Register Your Team →',
        'stat-hours': 'Hours',
        'stat-runners': 'Runners per Team',
        'stat-goal-number': '1 Goal',
        'stat-goal': 'Support the NCFS',
        'hero-date': 'April 5th & 6th 2026',
        'about-title': 'About the Event',
        'about-text-1': 'This 24-hour team relay run is more than just a race – it\'s a celebration of community, endurance, and support for those affected by Cystic Fibrosis. The Nederlandse Cystic Fibrosis Stichting (NCFS) supports research efforts to tackle this disease as well as families in their times of need.',
        'about-text-2': 'Teams of max 6 runners will run the 400m athletics track for 24 hours straight, a true test of endurance. While one runner from each team is on the track, the rest of the team will be supporting their runner and enjoying the campsite atmosphere in tents, or campervans next to the track, creating a festival-like feeling.',
        'about-why-title': 'Why NCFS?',
        'about-why-text': 'The Nederlandse Cystic Fibrosis Stichting provides crucial support to families affected by Cystic Fibrosis, including medical care, research funding, and community support. This event is our way of giving back to an organization that has made a real difference in our lives.',
        'about-why-link': 'Find out more',
        'about-image-text': 'Supporting NCFS',
        'event-title': 'Event Details',
        'event-date-title': 'Date & Time',
        'event-date-text': 'The run begins at 14:00 on April 5th 2026 and ends at 14:00 on April 6th',
        'event-location-title': 'Location',
        'event-team-title': 'Team Size',
        'event-team-text': 'Max 6 runners per team. Teams can rotate runners as needed during the 24 hours',
        'event-prizes-title': 'Prizes',
        'event-prizes-text': 'Top 3 teams for funds raised and total distance covered',
        'rules-title': 'Event Rules & Guidelines',
        'rules-running-title': 'Running Rules',
        'rules-running-1': 'Minimum of one runner per team on the track at any time',
        'rules-running-2': 'Teams can rotate runners as frequently as needed',
        'rules-running-3': 'All runners must stay within the designated track area',
        'rules-running-4': 'Safety is our top priority - follow all track rules',
        'rules-camping-title': 'Camping & Facilities',
        'rules-camping-1': 'Teams can set up tents, or bring campervans',
        'rules-camping-2': 'Designated camping areas will be provided',
        'rules-camping-3': 'Basic facilities will be available on-site',
        'rules-camping-4': 'Please bring your own food and drinks',
        'rules-camping-5': 'Respect other teams\' space and keep noise levels reasonable',
        'rules-fundraising-title': 'Fundraising',
        'rules-fundraising-1': 'Each team is encouraged to raise funds for NCFS',
        'rules-fundraising-2': 'Fundraising progress will be tracked throughout the event',
        'rules-fundraising-3': 'All donations go directly to NCFS',
        'rules-fundraising-4': 'Teams will create their own actie on the NCFS fundraising site',
        'footer-title': 'Around the Clock Run',
        'footer-description': '24-hour team relay run supporting the Nederlandse Cystic Fibrosis Stichting (NCFS)',
        'footer-links-title': 'Quick Links',
        'footer-support-title': 'Support NCFS',
        'footer-support-text': 'Learn more about the Nederlandse Cystic Fibrosis Stichting and their important work supporting families affected by Cystic Fibrosis.',
        'footer-copyright': '© 2024 Around the Clock Run. All rights reserved.',
        'form-title': 'Register Your Team',
        'form-team-name': 'Team Name *',
        'form-team-name-placeholder': 'Enter your team name',
        'form-captain-name': 'Team Captain Name *',
        'form-captain-name-placeholder': 'Full name of team captain',
        'form-captain-email': 'Team Captain Email *',
        'form-captain-phone': 'Team Captain Phone *',
        'form-description': 'Team Description',
        'form-description-placeholder': 'Tell us about your team, your motivation, or any special details...',
        'form-members': 'Team Members (max 6) *',
        'form-members-placeholder': 'List the names of all team members (one per line)',
        'form-members-hint': 'Please list each team member\'s name on a separate line',
        'form-info-title': 'What happens next?',
        'form-info-text': 'After you submit your registration, the organizers will confirm your registration and send you the logistics information for the run by email in due course.',
        'form-cancel': 'Cancel',
        'form-submit': 'Submit Registration',
        'form-sending': 'Sending...'
    }
};

// Get current language from localStorage or default to Dutch
let currentLanguage = localStorage.getItem('language') || 'nl';

// Function to update all translatable elements
function updateLanguage(lang) {
    currentLanguage = lang;
    localStorage.setItem('language', lang);
    document.documentElement.lang = lang;
    
    // Update all elements with data-i18n attribute
    document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');
        if (translations[lang] && translations[lang][key]) {
            element.textContent = translations[lang][key];
        }
    });
    
    // Update all elements with data-i18n-placeholder attribute
    document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
        const key = element.getAttribute('data-i18n-placeholder');
        if (translations[lang] && translations[lang][key]) {
            element.placeholder = translations[lang][key];
        }
    });
    
    // Update page title
    const titleElement = document.querySelector('title');
    if (titleElement && translations[lang]['page-title']) {
        titleElement.textContent = translations[lang]['page-title'];
    }
}

// Initialize language on page load
document.addEventListener('DOMContentLoaded', () => {
    updateLanguage(currentLanguage);
    
    // Language toggle button
    const languageToggle = document.getElementById('languageToggle');
    if (languageToggle) {
        languageToggle.addEventListener('click', () => {
            const newLang = currentLanguage === 'nl' ? 'en' : 'nl';
            updateLanguage(newLang);
        });
    }
});

// Mobile Navigation
const hamburger = document.querySelector('.hamburger');
const navMenu = document.querySelector('.nav-menu');

if (hamburger && navMenu) {
    hamburger.addEventListener('click', () => {
        hamburger.classList.toggle('active');
        navMenu.classList.toggle('active');
    });

    // Close mobile menu when clicking on a link
    document.querySelectorAll('.nav-menu a').forEach(link => {
        link.addEventListener('click', () => {
            hamburger.classList.remove('active');
            navMenu.classList.remove('active');
        });
    });
}

// Smooth scrolling for navigation links
document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
            target.scrollIntoView({
                behavior: 'smooth',
                block: 'start'
            });
        }
    });
});

// FAQ Accordion
document.querySelectorAll('.faq-question').forEach(question => {
    question.addEventListener('click', () => {
        const faqItem = question.parentElement;
        const isActive = faqItem.classList.contains('active');
        
        // Close all FAQ items
        document.querySelectorAll('.faq-item').forEach(item => {
            item.classList.remove('active');
        });
        
        // Open clicked item if it wasn't active
        if (!isActive) {
            faqItem.classList.add('active');
        }
    });
});

// Registration Modal - Global function to close modal
function closeRegistrationModal() {
    const registrationModal = document.getElementById('registrationModal');
    if (registrationModal) {
        registrationModal.classList.remove('active');
        document.body.style.overflow = '';
    }
}

// Registration Modal - Initialize when DOM is ready
document.addEventListener('DOMContentLoaded', () => {
    const registrationModal = document.getElementById('registrationModal');
    const openRegistrationModal = document.getElementById('openRegistrationModal');
    const closeRegistrationModalBtn = document.getElementById('closeRegistrationModal');
    const cancelRegistration = document.getElementById('cancelRegistration');

    if (openRegistrationModal && registrationModal) {
        openRegistrationModal.addEventListener('click', () => {
            registrationModal.classList.add('active');
            document.body.style.overflow = 'hidden';
        });
    }

    if (closeRegistrationModalBtn) {
        closeRegistrationModalBtn.addEventListener('click', closeRegistrationModal);
    }

    if (cancelRegistration) {
        cancelRegistration.addEventListener('click', closeRegistrationModal);
    }

    // Close modal when clicking outside
    if (registrationModal) {
        registrationModal.addEventListener('click', (e) => {
            if (e.target === registrationModal) {
                closeRegistrationModal();
            }
        });
    }

    // Close modal on Escape key
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && registrationModal && registrationModal.classList.contains('active')) {
            closeRegistrationModal();
        }
    });
});

// Form handling with Resend integration
const signupForm = document.getElementById('signupForm');
const contactForm = document.getElementById('contactForm');
const formMessage = document.getElementById('formMessage');

// Signup form submission
if (signupForm) {
    signupForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        
        const submitButton = signupForm.querySelector('.btn-primary');
        const buttonText = submitButton.querySelector('.button-text');
        const buttonLoading = submitButton.querySelector('.button-loading');
        
        // Show loading state
        if (buttonText) buttonText.style.display = 'none';
        if (buttonLoading) buttonLoading.style.display = 'inline-block';
        submitButton.disabled = true;
        
        try {
            const formData = new FormData(signupForm);
            const data = Object.fromEntries(formData);
            
            // Generate email body with all form data
            const emailBody = generateEmailBody(data);
            const subject = currentLanguage === 'nl' 
                ? `Rond de Klok voor de NCFS Team Registratie: ${data.teamName}`
                : `Around the Clock for the NCFS Team Registration: ${data.teamName}`;
            const mailtoLink = `mailto:tomjdevine@gmail.com?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(emailBody)}`;
            
            // Open email client with pre-filled data
            window.location.href = mailtoLink;
            const successMessage = currentLanguage === 'nl'
                ? 'Je e-mailclient wordt geopend om registratiegegevens te verzenden...'
                : 'Opening your email client to send registration details...';
            showMessage(successMessage, 'success');
            signupForm.reset();
            setTimeout(() => {
                closeRegistrationModal();
            }, 1500);
            
        } catch (error) {
            console.error('Error:', error);
            const errorMessage = currentLanguage === 'nl'
                ? 'Sorry, er is een fout opgetreden bij het indienen van je registratie. Probeer het opnieuw of neem rechtstreeks contact met ons op via tomjdevine@gmail.com'
                : 'Sorry, there was an error submitting your registration. Please try again or contact us directly at tomjdevine@gmail.com';
            showMessage(errorMessage, 'error');
        } finally {
            // Reset button state
            if (buttonText) buttonText.style.display = 'inline-block';
            if (buttonLoading) buttonLoading.style.display = 'none';
            submitButton.disabled = false;
        }
    });
}

function generateEmailBody(data) {
    const isDutch = currentLanguage === 'nl';
    return isDutch 
        ? `Team Registratie Formulier Inzending

Teamnaam: ${data.teamName}
Team Captain: ${data.teamCaptain}
Email: ${data.email}
Telefoon: ${data.phone}

Team Beschrijving:
${data.description || 'N/A'}

Teamleden:
${data.teamMembers}

---
Deze registratie is ingediend via de Rond de Klok Loop website.`
        : `Team Registration Form Submission

Team Name: ${data.teamName}
Team Captain: ${data.teamCaptain}
Email: ${data.email}
Phone: ${data.phone}

Team Description:
${data.description || 'N/A'}

Team Members:
${data.teamMembers}

---
This registration was submitted through the Around the Clock Run website.`;
}

// Contact form submission
if (contactForm) {
    contactForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const submitButton = contactForm.querySelector('.submit-button');
    const originalText = submitButton.textContent;
    
    // Show loading state
    submitButton.textContent = 'Sending...';
    submitButton.disabled = true;
    
    try {
        const formData = new FormData(contactForm);
        const data = Object.fromEntries(formData);
        
        // Send email using Resend
        const response = await fetch('/api/send-contact-email', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                to: 'info@aroundtheclockrun.nl', // Your email address
                subject: `Contact Form: ${data.subject}`,
                html: generateContactEmailHTML(data),
                contactData: data
            })
        });
        
        if (response.ok) {
            showMessage('Thank you for your message! We\'ll get back to you soon.', 'success');
            contactForm.reset();
        } else {
            throw new Error('Failed to send email');
        }
    } catch (error) {
        console.error('Error:', error);
        showMessage('Sorry, there was an error sending your message. Please try again or contact us directly.', 'error');
    } finally {
        // Reset button state
        submitButton.textContent = originalText;
        submitButton.disabled = false;
    }
    });
}

// Helper function to show messages
function showMessage(message, type) {
    const formMessage = document.getElementById('formMessage');
    if (formMessage) {
        formMessage.textContent = message;
        formMessage.className = `form-message ${type}`;
        formMessage.style.display = 'block';
        
        // Scroll to message
        formMessage.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        
        // Hide message after 5 seconds
        setTimeout(() => {
            formMessage.style.display = 'none';
        }, 5000);
    } else {
        // Fallback: show alert if formMessage element doesn't exist
        alert(message);
    }
}

// Generate HTML for signup email
function generateSignupEmailHTML(data) {
    return `
        <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;">
            <h2 style="color: #2563eb;">New Team Registration - Around the Clock Run</h2>
            
            <div style="background: #f8fafc; padding: 20px; border-radius: 10px; margin: 20px 0;">
                <h3 style="color: #1e293b; margin-bottom: 15px;">Team Information</h3>
                <p><strong>Team Name:</strong> ${data.teamName}</p>
                <p><strong>Team Captain:</strong> ${data.teamCaptain}</p>
                <p><strong>Email:</strong> ${data.email}</p>
                <p><strong>Phone:</strong> ${data.phone}</p>
                <p><strong>Team Size:</strong> ${data.teamSize} runners</p>
                <p><strong>Accommodation:</strong> ${data.accommodation || 'Not specified'}</p>
            </div>
            
            ${data.teamMembers ? `
            <div style="background: #f8fafc; padding: 20px; border-radius: 10px; margin: 20px 0;">
                <h3 style="color: #1e293b; margin-bottom: 15px;">Team Members</h3>
                <p style="white-space: pre-line;">${data.teamMembers}</p>
            </div>
            ` : ''}
            
            ${data.experience ? `
            <div style="background: #f8fafc; padding: 20px; border-radius: 10px; margin: 20px 0;">
                <h3 style="color: #1e293b; margin-bottom: 15px;">Running Experience</h3>
                <p style="white-space: pre-line;">${data.experience}</p>
            </div>
            ` : ''}
            
            ${data.fundraising ? `
            <div style="background: #f8fafc; padding: 20px; border-radius: 10px; margin: 20px 0;">
                <h3 style="color: #1e293b; margin-bottom: 15px;">Fundraising Plans</h3>
                <p style="white-space: pre-line;">${data.fundraising}</p>
            </div>
            ` : ''}
            
            ${data.additionalInfo ? `
            <div style="background: #f8fafc; padding: 20px; border-radius: 10px; margin: 20px 0;">
                <h3 style="color: #1e293b; margin-bottom: 15px;">Additional Information</h3>
                <p style="white-space: pre-line;">${data.additionalInfo}</p>
            </div>
            ` : ''}
            
            <div style="background: #e0f2fe; padding: 15px; border-radius: 8px; margin: 20px 0;">
                <p style="margin: 0; color: #0369a1;"><strong>Next Steps:</strong> Please review this registration and contact the team to confirm participation and provide further details about the event.</p>
            </div>
        </div>
    `;
}

// Generate HTML for contact email
function generateContactEmailHTML(data) {
    return `
        <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;">
            <h2 style="color: #2563eb;">New Contact Form Submission</h2>
            
            <div style="background: #f8fafc; padding: 20px; border-radius: 10px; margin: 20px 0;">
                <p><strong>Name:</strong> ${data.name}</p>
                <p><strong>Email:</strong> ${data.email}</p>
                <p><strong>Subject:</strong> ${data.subject}</p>
            </div>
            
            <div style="background: #f8fafc; padding: 20px; border-radius: 10px; margin: 20px 0;">
                <h3 style="color: #1e293b; margin-bottom: 15px;">Message</h3>
                <p style="white-space: pre-line;">${data.message}</p>
            </div>
        </div>
    `;
}

// Hero animations on load
document.addEventListener('DOMContentLoaded', () => {
    const heroElements = document.querySelectorAll('.hero-left > *, .hero-right');
    if (heroElements.length > 0) {
        heroElements.forEach((el, index) => {
            el.style.opacity = '0';
            el.style.transform = 'translateY(20px)';
            el.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
            
            setTimeout(() => {
                el.style.opacity = '1';
                el.style.transform = 'translateY(0)';
            }, index * 100);
        });
    }
});

// Navbar scroll effect
window.addEventListener('scroll', () => {
    const navbar = document.querySelector('.navbar');
    if (window.scrollY > 100) {
        navbar.style.background = 'rgba(255, 255, 255, 0.98)';
        navbar.style.boxShadow = '0 2px 20px rgba(0, 0, 0, 0.1)';
    } else {
        navbar.style.background = 'rgba(255, 255, 255, 0.95)';
        navbar.style.boxShadow = 'none';
    }
});

// Intersection Observer for animations
const observerOptions = {
    threshold: 0.1,
    rootMargin: '0px 0px -50px 0px'
};

const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
        if (entry.isIntersecting) {
            entry.target.style.opacity = '1';
            entry.target.style.transform = 'translateY(0)';
        }
    });
}, observerOptions);

// Observe elements for animation
document.addEventListener('DOMContentLoaded', () => {
    const animateElements = document.querySelectorAll('.detail-card, .rule-category, .faq-item');
    animateElements.forEach(el => {
        el.style.opacity = '0';
        el.style.transform = 'translateY(30px)';
        el.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
        observer.observe(el);
    });
});

// Form validation
function validateForm(form) {
    const requiredFields = form.querySelectorAll('[required]');
    let isValid = true;
    
    requiredFields.forEach(field => {
        if (!field.value.trim()) {
            field.style.borderColor = '#ef4444';
            isValid = false;
        } else {
            field.style.borderColor = '#e5e7eb';
        }
    });
    
    // Email validation
    const emailField = form.querySelector('input[type="email"]');
    if (emailField && emailField.value) {
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(emailField.value)) {
            emailField.style.borderColor = '#ef4444';
            isValid = false;
        }
    }
    
    return isValid;
}

// Add validation to forms
if (signupForm) {
    signupForm.addEventListener('submit', (e) => {
        if (!validateForm(signupForm)) {
            e.preventDefault();
            const errorMessage = currentLanguage === 'nl'
                ? 'Vul alle verplichte velden correct in.'
                : 'Please fill in all required fields correctly.';
            showMessage(errorMessage, 'error');
        }
    });
}

if (contactForm) {
    contactForm.addEventListener('submit', (e) => {
        if (!validateForm(contactForm)) {
            e.preventDefault();
            const errorMessage = currentLanguage === 'nl'
                ? 'Vul alle verplichte velden correct in.'
                : 'Please fill in all required fields correctly.';
            showMessage(errorMessage, 'error');
        }
    });
}

// Remove error styling on input
document.querySelectorAll('input, textarea, select').forEach(field => {
    field.addEventListener('input', () => {
        field.style.borderColor = '#e5e7eb';
    });
});
